<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>로또 대시보드</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', 'Apple SD Gothic Neo', Arial, sans-serif; margin: 0; background:#0f172a; color:#e5e7eb;}
      .wrap { max-width: 1100px; margin: 32px auto; padding: 16px; }
      .grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
      @media (min-width: 960px) { .grid { grid-template-columns: 1fr 1fr; } }
      .card { background: #111827; border: 1px solid #1f2937; border-radius: 16px; padding: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.25); }
      h1,h2 { margin: 0 0 10px; }
      a { color:#93c5fd; text-decoration: none; }
      table { width:100%; border-collapse: collapse; }
      th, td { padding: 8px; border-bottom: 1px solid #1f2937; font-variant-numeric: tabular-nums; }
      th { color:#9ca3af; text-align:left; }
      .small { color:#94a3b8; font-size: 13px; }
      .badge { display:inline-block; padding:2px 8px; background:#0b1220; border:1px solid #1f2937; border-radius:999px; font-size:12px; color:#cbd5e1;}
      .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
      .mt8 { margin-top: 8px; } .mt12 { margin-top: 12px; } .mt16 { margin-top: 16px; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="row">
        <h1>로또 대시보드</h1>
        <span class="badge">최신 회차: {{ last_round if last_round else '-' }}</span>
        <span class="small"><a href="/latest">최근 10회</a> · <a href="/shops">1등 당첨점</a> · <a href="/recs">추천 목록</a></span>
      </div>

      <div class="grid mt16">
        <div class="card">
          <h2>최근 10회 당첨번호</h2>
          {% if draws %}
          <table>
            <thead><tr><th>회차</th><th>추첨일</th><th>번호</th><th>보너스</th></tr></thead>
            <tbody>
              {% for d in draws %}
              <tr>
                <td>{{ d.round }}</td>
                <td>{{ d.draw_date }}</td>
                <td>{{ d.n1 }}, {{ d.n2 }}, {{ d.n3 }}, {{ d.n4 }}, {{ d.n5 }}, {{ d.n6 }}</td>
                <td>{{ d.bonus }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <div class="small mt8"><a href="/latest">전체보기 →</a></div>
          {% else %}
          <p class="small">데이터가 없습니다. 먼저 당첨번호를 업데이트하세요.</p>
          <p class="small">CLI: <code>lotto_manager update-range 1100 1200</code> 또는 <code>lotto_manager update-latest</code></p>
          {% endif %}
        </div>

        <div class="card">
          <h2>최근 추천 (최대 10개)</h2>
          {% if recs %}
          <table>
            <thead><tr><th>ID</th><th>라운드</th><th>종류</th><th>번호</th><th>신뢰도</th></tr></thead>
            <tbody>
              {% for r in recs %}
              <tr>
                <td>{{ r.id }}</td>
                <td>{{ r.round }}</td>
                <td>{{ '완전' if r.kind=='full' else '반자동' }}</td>
                <td>{{ r.numbers }}</td>
                <td>{{ '%.2f'|format(r.confidence or 0) }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <div class="small mt8"><a href="/recs">추천 목록 전체 →</a></div>
          {% else %}
          <p class="small">추천 데이터가 없습니다. 먼저 추천을 생성하세요.</p>
          <p class="small">CLI: <code>lotto_manager rec-generate</code></p>
          {% endif %}

          <div class="mt16">
            <div class="small">API 즐겨찾기: <a href="/api/analysis/summary">/api/analysis/summary</a></div>
          </div>
        </div>

        <div class="card">
          <h2>{{ last_round if last_round else '-' }}회차 1등 당첨점</h2>
          {% if shops %}
          <table>
            <thead><tr><th>순위</th><th>상호</th><th>주소</th></tr></thead>
            <tbody>
              {% for s in shops[:10] %}
              <tr>
                <td>{{ s.rank }}</td>
                <td>{{ s.name }}</td>
                <td>{{ s.address }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <div class="small mt8"><a href="/shops/{{ last_round }}">자세히 보기 →</a></div>
          {% else %}
          <p class="small">당첨점 데이터가 없습니다. 회차를 지정해 수집하세요.</p>
          <p class="small">CLI: <code>lotto_manager shops &lt;회차&gt;</code></p>
          {% endif %}
        </div>

        <div class="card">
          <h2>빠른 가이드</h2>
          <ul class="small">
            <li>당첨번호 수집: <code>lotto_manager update-range 1100 1150</code> 또는 <code>update-latest</code></li>
            <li>추천 생성: <code>lotto_manager rec-generate</code></li>
            <li>당첨점 수집: <code>lotto_manager shops &lt;회차&gt;</code></li>
            <li>웹: <a href="/latest">최근 10회</a> · <a href="/shops">1등 당첨점</a> · <a href="/recs">추천 목록</a></li>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>
